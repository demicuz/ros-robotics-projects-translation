# 4.7. Использование Arduino с ROS

Использование платы Arduino с ROS просто означает запуск узла ROS на Arduino, который может публиковать/подписываться как обычный узел ROS. Узел Arduino ROS может быть использован для получения и вывода значения датчиков в среде ROS, а другие узлы могут обрабатывать их. Кроме того, мы можем управлять устройствами, например, приводами, такими как двигатели, путем публикации значения для узла Arduino. Основная связь между ПК и Arduino происходит через UART. Существует специальный протокол под названием Ros Serial \([http://wiki.ros.org/rosserial/Overview](http://wiki.ros.org/rosserial/Overview)\), реализованный в виде мета-пакета ROS под названием `rosserial`, который может кодировать и декодировать последовательные сообщения ROS. Используя протокол ROS Serial, мы можем публиковать и подписываться на Arduino, как узел ROS через UART.

Чтобы начать использовать ROS с Arduino выполните шаги:

1.Мы должны установить некоторые пакеты ROS на Ubuntu. Для их установки можно использовать команды.

2. Установка `rosserial`:

```text
$ sudo apt-get install ros-kinetic-rosserial
```

3. Следующая команда установит клиентский пакет `rosserial-arduino` на ROS. Этот пакет помогает создать клиентскую библиотеку в Arduino IDE для ROS. Используя эту библиотеку, мы можем создать узлы Arduino ROS, которые работают как обычные узлы.

```text
$ sudo apt-get install ros-kinetic-rosserial-arduino
```

4. После установки этих пакетов вам необходимо скачать и настроить Arduino IDE. Нам нужно скачать эту IDE для программирования плат Arduino. Можно загрузить последнюю версию Arduino IDE с сайта \([https://www.arduino.cc/en/Main/Software](https://www.arduino.cc/en/Main/Software)\).

5. Вы можете скачать Arduino IDE для Linux 64/32-бит в соответствии с вашей ОС и запустить исполняемый файла arduino после извлечения пакета.

6. Чтобы добавить библиотеку ROS для IDE Arduino, сначала вам нужно перейти в **File \| Preference** и установить **Sketchbook location** для эскизов, как показано на этом скриншоте:

![](../.gitbook/assets/image%20%282%29.png)

7. Перейдите в папку sketchbook и создайте папку`libraries`, если ее нет, и откройте терминал в папке библиотеки. Все библиотеки Arduino в этой папке. Введите следующую команду, чтобы сгенерировать библиотеку `ros_lib` для Arduino:

```text
$ rosrun rosserial_arduino make_libraries.py .
```

8. Вы увидите следующие сообщения, печатающиеся во время выполнения программы. Через некоторое время вы можете получить ошибку, но это нормально.

![](../.gitbook/assets/image%20%2832%29.png)

9. После выполнения этой команды будет сгенерирована папка `ros_lib`, это клиентская библиотека Arduino ROS Serial.

10. Теперь вы можете открыть IDE Arduino и проверить, что опция доступна в меню. Вы можете взять любой из примеров ROS, скомпилировать его и проверить, строится ли он без каких-либо ошибок:

![](../.gitbook/assets/image%20%2818%29.png)

Поздравляю! Вы успешно настроили `ros_lib` на Arduino. Теперь мы можем выполнить несколько экспериментов с использованием интерфейса ROS-Arduino.

